import{_ as E}from"./trash-C5cTaUq4.js";import{A as f,_ as K,a as U}from"./accordion-BoHO_jhh.js";import{_ as W,a as G,b as ee,S as te,c as oe}from"./sortable.core.esm-7JJL7OT_.js";import{d as F,u as L,X as O,o,c as d,e as r,a as s,t as v,w as P,f as b,g as ne,h as Q,F as C,r as D,N as se,P as B,Q as e,b as S,R as i,i as $,Y as R,Z as le}from"./index-BeQulRQk.js";import{g as ce}from"./utils-BZao-1VW.js";import"./x-mark-DGfxSzjv.js";const ae={class:""},ie=["data-disabled"],re={class:"handle flex-none py-1 px-1 rounded-md hover:bg-zinc-200 cursor-move"},ue={class:"w-0 flex-1 truncate text-xs capitalize"},de=F({__name:"Block",props:{block:null},emits:["remove","toggle"],setup(u,{emit:w}){const k=L(),l=O(),n=w,c=u;function y(){k.push({name:"/[section].[block]",params:{block:c.block.id,section:l.params.section}})}function p(a){const h=new DOMParser().parseFromString(a,"text/html").body.textContent;return h==="undefined"?a:h}return(a,m)=>{const h=W,V=E,z=G,N=ee;return o(),d("div",ae,[r("div",{class:"flex rounded border border-zinc-100 hover:bg-zinc-100 cursor-pointer active:ring-inset active:ring-2 active:ring-gray-700 data-[disabled=true]:text-zinc-500","data-disabled":u.block.disabled},[r("button",re,[s(h,{class:"inline w-4"})]),r("div",{onClick:y,class:"group mx-2 py-1 pr-1 text-sm flex-1 flex items-center max-w-full"},[r("div",ue,v(u.block.settings.title||u.block.settings.heading||p(u.block.settings.text)||u.block.name),1),r("button",{onClick:m[0]||(m[0]=P(M=>n("remove"),["stop"])),class:"flex-none invisible group-hover:visible py-[1px] px-[2px] rounded-md hover:bg-zinc-200"},[s(V,{class:"inline w-4"})]),r("button",{onClick:m[1]||(m[1]=P(M=>n("toggle"),["stop"])),class:"flex-none invisible group-hover:visible py-[1px] px-[2px] rounded-md hover:bg-zinc-200 ml-1"},[u.block.disabled?(o(),b(N,{key:1,class:"inline w-4"})):(o(),b(z,{key:0,class:"inline w-4"}))])])],8,ie)])}}}),me=F({__name:"BlocksGroup",props:{blocks:null,order:null},emits:["reorder","toggleBlock","removeBlock"],setup(u,{emit:w}){const k=u,l=w,n=ne("sortable");return Q(()=>{new te(n.value,{animation:150,ghostClass:"sortable-ghost",onEnd({newIndex:c,oldIndex:y}){const p=[...k.order],a=p.splice(y,1)[0];p.splice(c,0,a),l("reorder",p)}})}),(c,y)=>{const p=de;return o(),d("div",{ref_key:"sortable",ref:n,class:"space-y-1"},[(o(!0),d(C,null,D(u.blocks,a=>(o(),b(p,{key:a.id,block:a,onToggle:m=>l("toggleBlock",a.id),onRemove:m=>l("removeBlock",a.id)},null,8,["block","onToggle","onRemove"]))),128))],512)}}}),_e={key:0,class:"flex flex-col h-full overflow-hidden relative w-full"},pe={class:"flex-none p-2 border-b"},ge={class:"flex items-center"},fe={class:"ml-2 truncate"},ve={key:0,class:"mt-2 text-sm"},ke={class:"flex-1 overflow-y-auto"},be={key:1,class:"p-2 text-sm"},he={key:0,class:"flex-none border-t"},Re=F({__name:"[section]",setup(u){const w=L(),k=O(),l=se(),n=B(()=>l.getSectionData(k.params.section)),c=B(()=>n.value?l.getSectionBySlug(n.value.type):null),y=B(()=>l.canRemoveSection(k.params.section)),p=B(()=>{var t;return ce(((t=c.value)==null?void 0:t.settings)||[])}),a=B(()=>n.value.blocks_order.map(t=>n.value.blocks[t])),m=B(()=>{var g;const t=((g=c.value)==null?void 0:g.blocks)||[];return a.value.length===0?t:t.filter(x=>{const I=a.value.filter(A=>A.type===x.type);return x.limit===void 0?!0:I.length<x.limit})});Q(()=>{l.selectSection(k.params.section)});function h(){w.back()}function V(){l.removeSection(k.params.section),h()}function z(t){return l.getThemeDataValue(`sectionsData.${n.value.id}.settings.${t}`)}function N(t,g){return l.updateThemeDataValue(`sectionsData.${n.value.id}.settings.${t}`,g)}function M(t){const g=c.value.blocks.find(x=>x.type===t);l.addBlockToSection(n.value.id,g)}function X(t){l.updateThemeDataValue(["sectionsData",n.value.id,"blocks_order"],t)}function Y(t){l.toggleSectionBlock(n.value.id,t)}function Z(t){l.removeSectionBlock(n.value.id,t)}return(t,g)=>{const x=K,I=le,A=me,j=oe,q=U,H=E;return e(c)?(o(),d("div",_e,[r("header",pe,[r("div",ge,[r("button",{class:"p-1 px-2 rounded hover:bg-gray-200 focus:outline-none",onClick:h},[s(x,{class:"inline w-4"})]),r("span",fe,v(e(n).settings.heading||e(c).name),1)]),e(c).description?(o(),d("p",ve,v(e(c).description),1)):S("",!0)]),r("section",ke,[s(e(f).Root,{multiple:"",defaultValue:["blocks","Settings"]},{default:i(()=>[e(c).blocks.length>0?(o(),b(e(f).Item,{key:0,value:"blocks"},{default:i(()=>[s(e(f).ItemTrigger,null,{default:i(()=>[$(v(t.$t("Blocks"))+" ",1),s(e(f).ItemIndicator,null,{default:i(()=>[s(I)]),_:1})]),_:1}),s(e(f).ItemContent,null,{default:i(()=>[s(A,{class:"-mt-2 mb-2",blocks:e(a),order:e(n).blocks_order,onReorder:X,onToggleBlock:Y,onRemoveBlock:Z},null,8,["blocks","order"]),e(m).length>0?(o(),b(e(R).Root,{key:0,onSelect:g[0]||(g[0]=_=>M(_.value))},{default:i(()=>[s(e(R).Trigger,{class:"w-full text-sm text-blue-600 rounded-lg cursor-pointer outline-0 inline-flex items-center gap-2 px-2 py-1 hover:bg-gray-200 focus:ring-1 focus:ring-gray-700"},{default:i(()=>[s(j,{class:"w-4 h-4 inline mr-1"}),$(" "+v(t.$t("Add Block")),1)]),_:1}),s(e(R).Positioner,{class:"w-[var(--reference-width)] !z-10"},{default:i(()=>[s(e(R).Content,{class:"flex flex-col outline-0 gap-1 p-1 bg-white shadow border rounded-lg data-[state=open]:animate-fade-in"},{default:i(()=>[(o(!0),d(C,null,D(e(m),_=>(o(),b(e(R).Item,{key:_.type,value:_.type,class:"outline-0 rounded cursor-pointer px-2 py-2 hover:bg-gray-200"},{default:i(()=>[$(v(_.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:1})):S("",!0)]),_:1})]),_:1})):S("",!0),(o(!0),d(C,null,D(e(p),_=>(o(),b(e(f).Item,{value:_.name,key:_.name},{default:i(()=>[s(e(f).ItemTrigger,null,{default:i(()=>[$(v(_.name)+" ",1),s(e(f).ItemIndicator,null,{default:i(()=>[s(I)]),_:1})]),_:2},1024),s(e(f).ItemContent,null,{default:i(()=>[(o(!0),d(C,null,D(_.settings,T=>(o(),b(q,{key:T.id,value:z(T.id),setting:T,onInput:J=>N(T.id,J)},null,8,["value","setting","onInput"]))),128))]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1}),e(c).settings.length>0?(o(),d(C,{key:0},[],64)):(o(),d("p",be,v(t.$t("This section has no configuration")),1))]),e(y)?(o(),d("footer",he,[r("button",{class:"flex items-center w-full text-left py-2 px-4 text-red-500 hover:bg-gray-100",onClick:V},[s(H,{class:"inline mr-2 w-4"}),$(" "+v(t.$t("Remove section")),1)])])):S("",!0)])):S("",!0)}}});export{Re as default};
