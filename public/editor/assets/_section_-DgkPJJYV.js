import{_ as F}from"./popover-DdFZgmG-.js";import{A as p,g as W,_ as X,a as Y}from"./accordion-CRC5T-6A.js";import{_ as Z,a as G,b as ee,S as te,c as oe}from"./sortable.core.esm--t-KD5qh.js";import{d as A,u as j,p as q,o,c as _,a as u,b as s,t as y,w as E,f,g as ne,h as se,F as R,r as D,j as le,q as x,l as e,e as B,m as r,i as S,M as $,_ as ie}from"./index-DXXAnxpv.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ae={class:""},ce=["data-disabled"],re={class:"handle flex-none py-1 px-1 rounded-md hover:bg-zinc-200 cursor-move"},ue={class:"w-0 flex-1 truncate text-xs capitalize"},de=A({__name:"Block",props:{block:null},emits:["remove","toggle"],setup(d,{emit:w}){const v=j(),l=q(),n=w,c=d;function b(){v.push({name:"/[section].[block]",params:{block:c.block.id,section:l.params.section}})}return(g,i)=>{const h=Z,I=F,V=G,z=ee;return o(),_("div",ae,[u("div",{class:"flex rounded border border-zinc-100 hover:bg-zinc-100 cursor-pointer active:ring-inset active:ring-2 active:ring-gray-700 data-[disabled=true]:text-zinc-500","data-disabled":d.block.disabled},[u("button",re,[s(h,{class:"inline w-3"})]),u("div",{onClick:b,class:"group mx-2 py-1 pr-1 text-sm flex-1 flex items-center max-w-full"},[u("div",ue,y(d.block.settings.title||d.block.settings.heading||d.block.settings.text||d.block.name),1),u("button",{onClick:i[0]||(i[0]=E(M=>n("remove"),["stop"])),class:"flex-none invisible group-hover:visible py-[1px] px-[2px] rounded-md hover:bg-zinc-200"},[s(I,{class:"inline w-4"})]),u("button",{onClick:i[1]||(i[1]=E(M=>n("toggle"),["stop"])),class:"flex-none invisible group-hover:visible py-[1px] px-[2px] rounded-md hover:bg-zinc-200 ml-1"},[d.block.disabled?(o(),f(z,{key:1,class:"inline w-4"})):(o(),f(V,{key:0,class:"inline w-4"}))])])],8,ce)])}}}),_e=A({__name:"BlocksGroup",props:{blocks:null,order:null},emits:["reorder","toggleBlock","removeBlock"],setup(d,{emit:w}){const v=d,l=w,n=ne("sortable");return se(()=>{new te(n.value,{animation:150,ghostClass:"sortable-ghost",onEnd({newIndex:c,oldIndex:b}){const g=[...v.order],i=g.splice(b,1)[0];g.splice(c,0,i),l("reorder",g)}})}),(c,b)=>{const g=de;return o(),_("div",{ref_key:"sortable",ref:n,class:"space-y-1"},[(o(!0),_(R,null,D(d.blocks,i=>(o(),f(g,{key:i.id,block:i,onToggle:h=>l("toggleBlock",i.id),onRemove:h=>l("removeBlock",i.id)},null,8,["block","onToggle","onRemove"]))),128))],512)}}}),me={key:0,class:"flex flex-col h-full overflow-hidden relative w-full"},pe={class:"flex-none p-2 border-b"},ge={class:"flex items-center"},fe={class:"ml-2 truncate"},ve={key:0,class:"mt-2 text-sm"},ke={class:"flex-1 overflow-y-auto"},be={key:1},he={key:0,class:"flex-none border-t"},$e=A({__name:"[section]",setup(d){const w=j(),v=q(),l=le(),n=x(()=>l.getSectionData(v.params.section)),c=x(()=>n.value?l.getSectionBySlug(n.value.type):null),b=x(()=>l.canRemoveSection(v.params.section)),g=x(()=>{var t;return W(((t=c.value)==null?void 0:t.settings)||[])}),i=x(()=>n.value.blocks_order.map(t=>n.value.blocks[t])),h=x(()=>{var a;const t=((a=c.value)==null?void 0:a.blocks)||[];return i.value.length===0?t:t.filter(k=>{const T=i.value.filter(N=>N.type===k.type);return k.limit===void 0?!0:T.length<k.limit})});function I(){w.back()}function V(){l.removeSection(v.params.section),I()}function z(t){return l.getThemeDataValue(`sectionsData.${n.value.id}.settings.${t}`)}function M(t,a){return l.updateThemeDataValue(`sectionsData.${n.value.id}.settings.${t}`,a)}function L(t){const a=c.value.blocks.find(k=>k.type===t);l.addBlockToSection(n.value.id,a)}function P(t){l.updateThemeDataValue(["sectionsData",n.value.id,"blocks_order"],t)}function H(t){l.toggleSectionBlock(n.value.id,t)}function J(t){l.removeSectionBlock(n.value.id,t)}return(t,a)=>{const k=X,T=ie,N=_e,K=oe,O=Y,Q=F;return e(c)?(o(),_("div",me,[u("header",pe,[u("div",ge,[u("button",{class:"p-1 px-2 rounded hover:bg-gray-200 focus:outline-none",onClick:I},[s(k,{class:"inline w-4"})]),u("span",fe,y(e(n).settings.heading||e(c).name),1)]),e(c).description?(o(),_("p",ve,y(e(c).description),1)):B("",!0)]),u("section",ke,[s(e(p).Root,{multiple:"",defaultValue:["blocks","Settings"]},{default:r(()=>[e(c).blocks.length>0?(o(),f(e(p).Item,{key:0,value:"blocks"},{default:r(()=>[s(e(p).ItemTrigger,null,{default:r(()=>[a[1]||(a[1]=S(" Blocks ")),s(e(p).ItemIndicator,null,{default:r(()=>[s(T)]),_:1})]),_:1}),s(e(p).ItemContent,null,{default:r(()=>[s(N,{class:"-mt-2 mb-2",blocks:e(i),order:e(n).blocks_order,onReorder:P,onToggleBlock:H,onRemoveBlock:J},null,8,["blocks","order"]),e(h).length>0?(o(),f(e($).Root,{key:0,onSelect:a[0]||(a[0]=m=>L(m.value))},{default:r(()=>[s(e($).Trigger,{class:"w-full text-sm text-blue-600 rounded-lg cursor-pointer outline-0 inline-flex items-center gap-2 px-2 py-1 hover:bg-gray-200 focus:ring-1 focus:ring-gray-700"},{default:r(()=>[s(K,{class:"w-4 h-4 inline mr-1"}),a[2]||(a[2]=S(" Add Block "))]),_:1}),s(e($).Positioner,{class:"w-[var(--reference-width)] !z-10"},{default:r(()=>[s(e($).Content,{class:"flex flex-col outline-0 gap-1 p-1 bg-white shadow border rounded-lg data-[state=open]:animate-fade-in"},{default:r(()=>[(o(!0),_(R,null,D(e(h),m=>(o(),f(e($).Item,{key:m.type,value:m.type,class:"outline-0 rounded cursor-pointer px-2 py-2 hover:bg-gray-200"},{default:r(()=>[S(y(m.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:1})):B("",!0)]),_:1})]),_:1})):B("",!0),(o(!0),_(R,null,D(e(g),m=>(o(),f(e(p).Item,{value:m.name,key:m.name},{default:r(()=>[s(e(p).ItemTrigger,null,{default:r(()=>[S(y(m.name)+" ",1),s(e(p).ItemIndicator,null,{default:r(()=>[s(T)]),_:1})]),_:2},1024),s(e(p).ItemContent,null,{default:r(()=>[(o(!0),_(R,null,D(m.settings,C=>(o(),f(O,{key:C.id,value:z(C.id),setting:C,onInput:U=>M(C.id,U)},null,8,["value","setting","onInput"]))),128))]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1}),e(c).settings.length>0?(o(),_(R,{key:0},[],64)):(o(),_("p",be,y("This section has no configuration")))]),e(b)?(o(),_("footer",he,[u("button",{class:"flex items-center w-full text-left py-2 px-4 text-red-500 hover:bg-gray-100",onClick:V},[s(Q,{class:"inline mr-2 w-4"}),a[3]||(a[3]=S(" Remove section "))])])):B("",!0)])):B("",!0)}}});export{$e as default};
