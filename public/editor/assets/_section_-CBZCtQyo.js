import{_ as Z,g as G,r as ee,a as oe,b as te,c as ne,d as se,e as le}from"./utils-Doqg0bWt.js";import{d as z,u as L,a3 as P,o as s,c as d,a as u,b as e,t as x,w as F,g as re,h as ce,F as S,r as C,f as h,a0 as ae,I as b,R as t,e as w,O as i,i as B,a4 as $,a5 as ie}from"./index-Dpbttelf.js";import{r as ue,a as de,S as me,b as pe}from"./sortable.core.esm-C3JPvvUW.js";import{r as O}from"./TextInput.vue_vue_type_script_setup_true_lang-BdikULfB.js";const _e={class:""},fe={class:"flex rounded border border-zinc-100 hover:bg-zinc-100 cursor-pointer active:ring-inset active:ring-2 active:ring-gray-700"},ge={class:"handle flex-none py-1 px-1 rounded-md hover:bg-zinc-200 cursor-move"},ve={class:"w-0 flex-1 truncate text-xs capitalize"},ke=z({__name:"Block",props:{block:null},emits:["remove","toggle"],setup(p,{emit:y}){const f=L(),l=P(),n=y,c=p;function v(){f.push({name:"/[section].[block]",params:{block:c.block.id,section:l.params.section}})}return(_,a)=>{const k=ue,I=O,D=de;return s(),d("div",_e,[u("div",fe,[u("button",ge,[e(k,{class:"inline w-3"})]),u("div",{onClick:v,class:"group mx-2 py-1 pr-1 text-sm flex-1 flex items-center max-w-full"},[u("div",ve,x(p.block.settings.title||p.block.settings.heading||p.block.settings.text||p.block.name),1),u("button",{onClick:a[0]||(a[0]=F(V=>n("remove"),["stop"])),class:"flex-none invisible group-hover:visible py-[1px] px-[2px] rounded-md hover:bg-zinc-200"},[e(I,{class:"inline w-4"})]),u("button",{onClick:a[1]||(a[1]=F(V=>n("toggle"),["stop"])),class:"flex-none invisible group-hover:visible py-[1px] px-[2px] rounded-md hover:bg-zinc-200 ml-1"},[e(D,{class:"inline w-4"})])])])])}}}),be=z({__name:"BlocksGroup",props:{blocks:null,order:null},emits:["reorder","toggleBlock","removeBlock"],setup(p,{emit:y}){const f=p,l=y,n=re("sortable");return ce(()=>{new me(n.value,{animation:150,ghostClass:"sortable-ghost",onEnd({newIndex:c,oldIndex:v}){const _=[...f.order],a=_.splice(v,1)[0];_.splice(c,0,a),l("reorder",_)}})}),(c,v)=>{const _=ke;return s(),d("div",{ref_key:"sortable",ref:n,class:"space-y-1"},[(s(!0),d(S,null,C(p.blocks,a=>(s(),h(_,{block:a,onToggle:k=>l("toggleBlock",a.id),onRemove:k=>l("removeBlock",a.id)},null,8,["block","onToggle","onRemove"]))),256))],512)}}}),xe={key:0,class:"flex flex-col h-full overflow-hidden relative w-full"},he={class:"flex-none p-2 border-b"},ye={class:"flex items-center"},we={class:"ml-2 truncate"},Be={key:0,class:"mt-2 text-sm"},$e={class:"flex-1 overflow-y-auto"},Se={key:1},Ie={key:0,class:"flex-none border-t"},De=z({__name:"[section]",setup(p){const y=L(),f=P(),l=ae(),n=b(()=>l.getSectionData(f.params.section)),c=b(()=>n.value?l.getSectionBySlug(n.value.type):null),v=b(()=>l.canRemoveSection(f.params.section)),_=b(()=>{var o;return G(((o=c.value)==null?void 0:o.settings)||[])}),a=b(()=>n.value.blocks_order.map(o=>n.value.blocks[o])),k=b(()=>{var r;const o=((r=c.value)==null?void 0:r.blocks)||[];return a.value.length===0?o:o.filter(g=>{const T=a.value.filter(R=>R.type===g.type);return g.limit===void 0?!0:T.length<g.limit})});function I(){y.back()}function D(){l.removeSection(f.params.section),I()}function V(o){return l.getThemeDataValue(`sectionsData.${n.value.id}.settings.${o}`)}function U(o,r){return l.updateThemeDataValue(`sectionsData.${n.value.id}.settings.${o}`,r)}function j(o){const r=c.value.blocks.find(g=>g.type===o);l.addBlockToSection(n.value.id,r)}function q(o){l.updateThemeDataValue(["sectionsData",n.value.id,"blocks_order"],o)}function H(o){l.toggleSectionBlock(n.value.id,o)}return(o,r)=>{const g=ee,T=ie,R=oe,N=te,J=be,K=pe,E=ne,M=se,Q=le,W=Z,X=O;return t(c)?(s(),d("div",xe,[u("header",he,[u("div",ye,[u("button",{class:"p-1 px-2 rounded hover:bg-gray-200 focus:outline-none",onClick:I},[e(g,{class:"inline w-4"})]),u("span",we,x(t(n).settings.heading||t(c).name),1)]),t(c).description?(s(),d("p",Be,x(t(c).description),1)):w("",!0)]),u("section",$e,[e(W,{multiple:"",defaultValue:["blocks","Settings"]},{default:i(()=>[t(c).blocks.length>0?(s(),h(M,{key:0,value:"blocks"},{default:i(()=>[e(N,null,{default:i(()=>[r[1]||(r[1]=B(" Blocks ")),e(R,null,{default:i(()=>[e(T)]),_:1})]),_:1}),e(E,null,{default:i(()=>[e(J,{class:"-mt-2 mb-2",blocks:t(a),order:t(n).blocks_order,onReorder:q,onToggleBlock:H},null,8,["blocks","order"]),t(k).length>0?(s(),h(t($).Root,{key:0,onSelect:r[0]||(r[0]=m=>j(m.value))},{default:i(()=>[e(t($).Trigger,{class:"w-full text-sm text-blue-600 rounded-lg cursor-pointer outline-0 inline-flex items-center gap-2 px-2 py-1 hover:bg-gray-200 focus:ring-1 focus:ring-gray-700"},{default:i(()=>[e(K,{class:"w-4 h-4 inline mr-1"}),r[2]||(r[2]=B(" Add Block "))]),_:1}),e(t($).Positioner,{class:"w-[var(--reference-width)] !z-10"},{default:i(()=>[e(t($).Content,{class:"flex flex-col outline-0 gap-1 p-1 bg-white shadow border rounded-lg data-[state=open]:animate-fade-in"},{default:i(()=>[(s(!0),d(S,null,C(t(k),m=>(s(),h(t($).Item,{key:m.type,value:m.type,class:"outline-0 rounded cursor-pointer px-2 py-2 hover:bg-gray-200"},{default:i(()=>[B(x(m.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:1})):w("",!0)]),_:1})]),_:1})):w("",!0),(s(!0),d(S,null,C(t(_),m=>(s(),h(M,{value:m.name,key:m.name},{default:i(()=>[e(N,null,{default:i(()=>[B(x(m.name)+" ",1),e(R,null,{default:i(()=>[e(T)]),_:1})]),_:2},1024),e(E,null,{default:i(()=>[(s(!0),d(S,null,C(m.settings,A=>(s(),h(Q,{key:A.id,value:V(A.id),setting:A,onInput:Y=>U(A.id,Y)},null,8,["value","setting","onInput"]))),128))]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1}),t(c).settings.length>0?(s(),d(S,{key:0},[],64)):(s(),d("p",Se,x("This section has no configuration")))]),t(v)?(s(),d("footer",Ie,[u("button",{class:"flex items-center w-full text-left py-2 px-4 text-red-500 hover:bg-gray-100",onClick:D},[e(X,{class:"inline mr-2 w-4"}),r[3]||(r[3]=B(" Remove section "))])])):w("",!0)])):w("",!0)}}});export{De as default};
