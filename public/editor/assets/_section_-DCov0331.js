import{_ as F}from"./trash-FE8D_FsM.js";import{A as p,_ as K,a as U}from"./accordion-CEQvqCVZ.js";import{_ as Y,a as Z,b as G,S as ee,c as te}from"./sortable.core.esm-TRoPElaG.js";import{d as A,u as P,V as L,o,c as m,a as u,b as s,t as y,w as E,f,g as oe,h as ne,F as R,r as V,M as se,O as x,P as e,e as w,Q as r,i as S,W as $,X as le}from"./index-BCjB5YWL.js";import{g as ie}from"./utils-BZao-1VW.js";import"./dialog-CRtp9Ph0.js";const ae={class:""},ce=["data-disabled"],re={class:"handle flex-none py-1 px-1 rounded-md hover:bg-zinc-200 cursor-move"},ue={class:"w-0 flex-1 truncate text-xs capitalize"},de=A({__name:"Block",props:{block:null},emits:["remove","toggle"],setup(d,{emit:B}){const v=P(),l=L(),n=B,c=d;function b(){v.push({name:"/[section].[block]",params:{block:c.block.id,section:l.params.section}})}return(g,i)=>{const h=Y,I=F,D=Z,z=G;return o(),m("div",ae,[u("div",{class:"flex rounded border border-zinc-100 hover:bg-zinc-100 cursor-pointer active:ring-inset active:ring-2 active:ring-gray-700 data-[disabled=true]:text-zinc-500","data-disabled":d.block.disabled},[u("button",re,[s(h,{class:"inline w-4"})]),u("div",{onClick:b,class:"group mx-2 py-1 pr-1 text-sm flex-1 flex items-center max-w-full"},[u("div",ue,y(d.block.settings.title||d.block.settings.heading||d.block.settings.text||d.block.name),1),u("button",{onClick:i[0]||(i[0]=E(M=>n("remove"),["stop"])),class:"flex-none invisible group-hover:visible py-[1px] px-[2px] rounded-md hover:bg-zinc-200"},[s(I,{class:"inline w-4"})]),u("button",{onClick:i[1]||(i[1]=E(M=>n("toggle"),["stop"])),class:"flex-none invisible group-hover:visible py-[1px] px-[2px] rounded-md hover:bg-zinc-200 ml-1"},[d.block.disabled?(o(),f(z,{key:1,class:"inline w-4"})):(o(),f(D,{key:0,class:"inline w-4"}))])])],8,ce)])}}}),me=A({__name:"BlocksGroup",props:{blocks:null,order:null},emits:["reorder","toggleBlock","removeBlock"],setup(d,{emit:B}){const v=d,l=B,n=oe("sortable");return ne(()=>{new ee(n.value,{animation:150,ghostClass:"sortable-ghost",onEnd({newIndex:c,oldIndex:b}){const g=[...v.order],i=g.splice(b,1)[0];g.splice(c,0,i),l("reorder",g)}})}),(c,b)=>{const g=de;return o(),m("div",{ref_key:"sortable",ref:n,class:"space-y-1"},[(o(!0),m(R,null,V(d.blocks,i=>(o(),f(g,{key:i.id,block:i,onToggle:h=>l("toggleBlock",i.id),onRemove:h=>l("removeBlock",i.id)},null,8,["block","onToggle","onRemove"]))),128))],512)}}}),_e={key:0,class:"flex flex-col h-full overflow-hidden relative w-full"},pe={class:"flex-none p-2 border-b"},ge={class:"flex items-center"},fe={class:"ml-2 truncate"},ve={key:0,class:"mt-2 text-sm"},ke={class:"flex-1 overflow-y-auto"},be={key:1},he={key:0,class:"flex-none border-t"},Re=A({__name:"[section]",setup(d){const B=P(),v=L(),l=se(),n=x(()=>l.getSectionData(v.params.section)),c=x(()=>n.value?l.getSectionBySlug(n.value.type):null),b=x(()=>l.canRemoveSection(v.params.section)),g=x(()=>{var t;return ie(((t=c.value)==null?void 0:t.settings)||[])}),i=x(()=>n.value.blocks_order.map(t=>n.value.blocks[t])),h=x(()=>{var a;const t=((a=c.value)==null?void 0:a.blocks)||[];return i.value.length===0?t:t.filter(k=>{const T=i.value.filter(N=>N.type===k.type);return k.limit===void 0?!0:T.length<k.limit})});function I(){B.back()}function D(){l.removeSection(v.params.section),I()}function z(t){return l.getThemeDataValue(`sectionsData.${n.value.id}.settings.${t}`)}function M(t,a){return l.updateThemeDataValue(`sectionsData.${n.value.id}.settings.${t}`,a)}function O(t){const a=c.value.blocks.find(k=>k.type===t);l.addBlockToSection(n.value.id,a)}function Q(t){l.updateThemeDataValue(["sectionsData",n.value.id,"blocks_order"],t)}function W(t){l.toggleSectionBlock(n.value.id,t)}function X(t){l.removeSectionBlock(n.value.id,t)}return(t,a)=>{const k=K,T=le,N=me,j=te,q=U,H=F;return e(c)?(o(),m("div",_e,[u("header",pe,[u("div",ge,[u("button",{class:"p-1 px-2 rounded hover:bg-gray-200 focus:outline-none",onClick:I},[s(k,{class:"inline w-4"})]),u("span",fe,y(e(n).settings.heading||e(c).name),1)]),e(c).description?(o(),m("p",ve,y(e(c).description),1)):w("",!0)]),u("section",ke,[s(e(p).Root,{multiple:"",defaultValue:["blocks","Settings"]},{default:r(()=>[e(c).blocks.length>0?(o(),f(e(p).Item,{key:0,value:"blocks"},{default:r(()=>[s(e(p).ItemTrigger,null,{default:r(()=>[a[1]||(a[1]=S(" Blocks ")),s(e(p).ItemIndicator,null,{default:r(()=>[s(T)]),_:1})]),_:1}),s(e(p).ItemContent,null,{default:r(()=>[s(N,{class:"-mt-2 mb-2",blocks:e(i),order:e(n).blocks_order,onReorder:Q,onToggleBlock:W,onRemoveBlock:X},null,8,["blocks","order"]),e(h).length>0?(o(),f(e($).Root,{key:0,onSelect:a[0]||(a[0]=_=>O(_.value))},{default:r(()=>[s(e($).Trigger,{class:"w-full text-sm text-blue-600 rounded-lg cursor-pointer outline-0 inline-flex items-center gap-2 px-2 py-1 hover:bg-gray-200 focus:ring-1 focus:ring-gray-700"},{default:r(()=>[s(j,{class:"w-4 h-4 inline mr-1"}),a[2]||(a[2]=S(" Add Block "))]),_:1}),s(e($).Positioner,{class:"w-[var(--reference-width)] !z-10"},{default:r(()=>[s(e($).Content,{class:"flex flex-col outline-0 gap-1 p-1 bg-white shadow border rounded-lg data-[state=open]:animate-fade-in"},{default:r(()=>[(o(!0),m(R,null,V(e(h),_=>(o(),f(e($).Item,{key:_.type,value:_.type,class:"outline-0 rounded cursor-pointer px-2 py-2 hover:bg-gray-200"},{default:r(()=>[S(y(_.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:1})):w("",!0)]),_:1})]),_:1})):w("",!0),(o(!0),m(R,null,V(e(g),_=>(o(),f(e(p).Item,{value:_.name,key:_.name},{default:r(()=>[s(e(p).ItemTrigger,null,{default:r(()=>[S(y(_.name)+" ",1),s(e(p).ItemIndicator,null,{default:r(()=>[s(T)]),_:1})]),_:2},1024),s(e(p).ItemContent,null,{default:r(()=>[(o(!0),m(R,null,V(_.settings,C=>(o(),f(q,{key:C.id,value:z(C.id),setting:C,onInput:J=>M(C.id,J)},null,8,["value","setting","onInput"]))),128))]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1}),e(c).settings.length>0?(o(),m(R,{key:0},[],64)):(o(),m("p",be,y("This section has no configuration")))]),e(b)?(o(),m("footer",he,[u("button",{class:"flex items-center w-full text-left py-2 px-4 text-red-500 hover:bg-gray-100",onClick:D},[s(H,{class:"inline mr-2 w-4"}),a[3]||(a[3]=S(" Remove section "))])])):w("",!0)])):w("",!0)}}});export{Re as default};
