var N=Object.defineProperty;var B=(S,a,p)=>a in S?N(S,a,{enumerable:!0,configurable:!0,writable:!0,value:p}):S[a]=p;var w=(S,a,p)=>B(S,typeof a!="symbol"?a+"":a,p);var C=function(){const S=()=>{},a={morphStyle:"outerHTML",callbacks:{beforeNodeAdded:S,afterNodeAdded:S,beforeNodeMorphed:S,afterNodeMorphed:S,beforeNodeRemoved:S,afterNodeRemoved:S,beforeAttributeUpdated:S},head:{style:"merge",shouldPreserve:c=>c.getAttribute("im-preserve")==="true",shouldReAppend:c=>c.getAttribute("im-re-append")==="true",shouldRemove:S,afterHeadMorphed:S},restoreFocus:!0};function p(c,v,u={}){c=T(c);const f=E(v),h=I(c,f,u),l=L(h,()=>H(h,c,f,i=>i.morphStyle==="innerHTML"?(y(i,c,f),Array.from(c.childNodes)):b(i,c,f)));return h.pantry.remove(),l}function b(c,v,u){const f=E(v);return y(c,f,u,v,v.nextSibling),Array.from(f.childNodes)}function L(c,v){var r;if(!c.config.restoreFocus)return v();let u=document.activeElement;if(!(u instanceof HTMLInputElement||u instanceof HTMLTextAreaElement))return v();const{id:f,selectionStart:h,selectionEnd:l}=u,i=v();return f&&f!==((r=document.activeElement)==null?void 0:r.id)&&(u=c.target.querySelector(`[id="${f}"]`),u==null||u.focus()),u&&!u.selectionEnd&&l&&u.setSelectionRange(h,l),i}const y=function(){function c(e,t,s,n=null,o=null){t instanceof HTMLTemplateElement&&s instanceof HTMLTemplateElement&&(t=t.content,s=s.content),n||(n=t.firstChild);for(const d of s.childNodes){if(n&&n!=o){const m=u(e,d,n,o);if(m){m!==n&&h(e,n,m),A(m,d,e),n=m.nextSibling;continue}}if(d instanceof Element&&e.persistentIds.has(d.id)){const m=l(t,d.id,n,e);A(m,d,e),n=m.nextSibling;continue}const g=v(t,d,n,e);g&&(n=g.nextSibling)}for(;n&&n!=o;){const d=n;n=n.nextSibling,f(e,d)}}function v(e,t,s,n){if(n.callbacks.beforeNodeAdded(t)===!1)return null;if(n.idMap.has(t)){const o=document.createElement(t.tagName);return e.insertBefore(o,s),A(o,t,n),n.callbacks.afterNodeAdded(o),o}else{const o=document.importNode(t,!0);return e.insertBefore(o,s),n.callbacks.afterNodeAdded(o),o}}const u=function(){function e(n,o,d,g){let m=null,k=o.nextSibling,q=0,M=d;for(;M&&M!=g;){if(s(M,o)){if(t(n,M,o))return M;m===null&&(n.idMap.has(M)||(m=M))}if(m===null&&k&&s(M,k)&&(q++,k=k.nextSibling,q>=2&&(m=void 0)),M.contains(document.activeElement))break;M=M.nextSibling}return m||null}function t(n,o,d){let g=n.idMap.get(o),m=n.idMap.get(d);if(!m||!g)return!1;for(const k of g)if(m.has(k))return!0;return!1}function s(n,o){const d=n,g=o;return d.nodeType===g.nodeType&&d.tagName===g.tagName&&(!d.id||d.id===g.id)}return e}();function f(e,t){var s;if(e.idMap.has(t))r(e.pantry,t,null);else{if(e.callbacks.beforeNodeRemoved(t)===!1)return;(s=t.parentNode)==null||s.removeChild(t),e.callbacks.afterNodeRemoved(t)}}function h(e,t,s){let n=t;for(;n&&n!==s;){let o=n;n=n.nextSibling,f(e,o)}return n}function l(e,t,s,n){const o=n.target.id===t&&n.target||n.target.querySelector(`[id="${t}"]`)||n.pantry.querySelector(`[id="${t}"]`);return i(o,n),r(e,o,s),o}function i(e,t){const s=e.id;for(;e=e.parentNode;){let n=t.idMap.get(e);n&&(n.delete(s),n.size||t.idMap.delete(e))}}function r(e,t,s){if(e.moveBefore)try{e.moveBefore(t,s)}catch{e.insertBefore(t,s)}else e.insertBefore(t,s)}return c}(),A=function(){function c(i,r,e){return e.ignoreActive&&i===document.activeElement?null:(e.callbacks.beforeNodeMorphed(i,r)===!1||(i instanceof HTMLHeadElement&&e.head.ignore||(i instanceof HTMLHeadElement&&e.head.style!=="morph"?O(i,r,e):(v(i,r,e),l(i,e)||y(e,i,r))),e.callbacks.afterNodeMorphed(i,r)),i)}function v(i,r,e){let t=r.nodeType;if(t===1){const s=i,n=r,o=s.attributes,d=n.attributes;for(const g of d)h(g.name,s,"update",e)||s.getAttribute(g.name)!==g.value&&s.setAttribute(g.name,g.value);for(let g=o.length-1;0<=g;g--){const m=o[g];if(m&&!n.hasAttribute(m.name)){if(h(m.name,s,"remove",e))continue;s.removeAttribute(m.name)}}l(s,e)||u(s,n,e)}(t===8||t===3)&&i.nodeValue!==r.nodeValue&&(i.nodeValue=r.nodeValue)}function u(i,r,e){if(i instanceof HTMLInputElement&&r instanceof HTMLInputElement&&r.type!=="file"){let t=r.value,s=i.value;f(i,r,"checked",e),f(i,r,"disabled",e),r.hasAttribute("value")?s!==t&&(h("value",i,"update",e)||(i.setAttribute("value",t),i.value=t)):h("value",i,"remove",e)||(i.value="",i.removeAttribute("value"))}else if(i instanceof HTMLOptionElement&&r instanceof HTMLOptionElement)f(i,r,"selected",e);else if(i instanceof HTMLTextAreaElement&&r instanceof HTMLTextAreaElement){let t=r.value,s=i.value;if(h("value",i,"update",e))return;t!==s&&(i.value=t),i.firstChild&&i.firstChild.nodeValue!==t&&(i.firstChild.nodeValue=t)}}function f(i,r,e,t){const s=r[e],n=i[e];if(s!==n){const o=h(e,i,"update",t);o||(i[e]=r[e]),s?o||i.setAttribute(e,""):h(e,i,"remove",t)||i.removeAttribute(e)}}function h(i,r,e,t){return i==="value"&&t.ignoreActiveValue&&r===document.activeElement?!0:t.callbacks.beforeAttributeUpdated(i,r,e)===!1}function l(i,r){return!!r.ignoreActiveValue&&i===document.activeElement&&i!==document.body}return c}();function H(c,v,u,f){if(c.head.block){const h=v.querySelector("head"),l=u.querySelector("head");if(h&&l){const i=O(h,l,c);return Promise.all(i).then(()=>{const r=Object.assign(c,{head:{block:!1,ignore:!0}});return f(r)})}}return f(c)}function O(c,v,u){let f=[],h=[],l=[],i=[],r=new Map;for(const t of v.children)r.set(t.outerHTML,t);for(const t of c.children){let s=r.has(t.outerHTML),n=u.head.shouldReAppend(t),o=u.head.shouldPreserve(t);s||o?n?h.push(t):(r.delete(t.outerHTML),l.push(t)):u.head.style==="append"?n&&(h.push(t),i.push(t)):u.head.shouldRemove(t)!==!1&&h.push(t)}i.push(...r.values());let e=[];for(const t of i){let s=document.createRange().createContextualFragment(t.outerHTML).firstChild;if(u.callbacks.beforeNodeAdded(s)!==!1){if("href"in s&&s.href||"src"in s&&s.src){let n,o=new Promise(function(d){n=d});s.addEventListener("load",function(){n()}),e.push(o)}c.appendChild(s),u.callbacks.afterNodeAdded(s),f.push(s)}}for(const t of h)u.callbacks.beforeNodeRemoved(t)!==!1&&(c.removeChild(t),u.callbacks.afterNodeRemoved(t));return u.head.afterHeadMorphed(c,{added:f,kept:l,removed:h}),e}const I=function(){function c(r,e,t){const{persistentIds:s,idMap:n}=l(r,e),o=v(t),d=o.morphStyle||"outerHTML";if(!["innerHTML","outerHTML"].includes(d))throw`Do not understand how to morph style ${d}`;return{target:r,newContent:e,config:o,morphStyle:d,ignoreActive:o.ignoreActive,ignoreActiveValue:o.ignoreActiveValue,restoreFocus:o.restoreFocus,idMap:n,persistentIds:s,pantry:u(),callbacks:o.callbacks,head:o.head}}function v(r){let e=Object.assign({},a);return Object.assign(e,r),e.callbacks=Object.assign({},a.callbacks,r.callbacks),e.head=Object.assign({},a.head,r.head),e}function u(){const r=document.createElement("div");return r.hidden=!0,document.body.insertAdjacentElement("afterend",r),r}function f(r){let e=Array.from(r.querySelectorAll("[id]"));return r.id&&e.push(r),e}function h(r,e,t,s){for(const n of s)if(e.has(n.id)){let o=n;for(;o;){let d=r.get(o);if(d==null&&(d=new Set,r.set(o,d)),d.add(n.id),o===t)break;o=o.parentElement}}}function l(r,e){const t=f(r),s=f(e),n=i(t,s);let o=new Map;h(o,n,r,t);const d=e.__idiomorphRoot||e;return h(o,n,d,s),{persistentIds:n,idMap:o}}function i(r,e){let t=new Set,s=new Map;for(const{id:o,tagName:d}of r)s.has(o)?t.add(o):s.set(o,d);let n=new Set;for(const{id:o,tagName:d}of e)n.has(o)?t.add(o):s.get(o)===d&&n.add(o);for(const o of t)n.delete(o);return n}return c}(),{normalizeElement:T,normalizeParent:E}=function(){const c=new WeakSet;function v(l){return l instanceof Document?l.documentElement:l}function u(l){if(l==null)return document.createElement("div");if(typeof l=="string")return u(h(l));if(c.has(l))return l;if(l instanceof Node){if(l.parentNode)return new f(l);{const i=document.createElement("div");return i.append(l),i}}else{const i=document.createElement("div");for(const r of[...l])i.append(r);return i}}class f{constructor(i){this.originalNode=i,this.realParentNode=i.parentNode,this.previousSibling=i.previousSibling,this.nextSibling=i.nextSibling}get childNodes(){const i=[];let r=this.previousSibling?this.previousSibling.nextSibling:this.realParentNode.firstChild;for(;r&&r!=this.nextSibling;)i.push(r),r=r.nextSibling;return i}querySelectorAll(i){return this.childNodes.reduce((r,e)=>{if(e instanceof Element){e.matches(i)&&r.push(e);const t=e.querySelectorAll(i);for(let s=0;s<t.length;s++)r.push(t[s])}return r},[])}insertBefore(i,r){return this.realParentNode.insertBefore(i,r)}moveBefore(i,r){return this.realParentNode.moveBefore(i,r)}get __idiomorphRoot(){return this.originalNode}}function h(l){let i=new DOMParser,r=l.replace(/<svg(\s[^>]*>|>)([\s\S]*?)<\/svg>/gim,"");if(r.match(/<\/html>/)||r.match(/<\/head>/)||r.match(/<\/body>/)){let e=i.parseFromString(l,"text/html");if(r.match(/<\/html>/))return c.add(e),e;{let t=e.firstChild;return t&&c.add(t),t}}else{let t=i.parseFromString("<body><template>"+l+"</template></body>","text/html").body.querySelector("template").content;return c.add(t),t}}return{normalizeElement:v,normalizeParent:u}}();return{morph:p,defaults:a}}();window.addEventListener("DOMContentLoaded",function(){new V().init()});class V{constructor(){w(this,"sectionOverlay");w(this,"sectionLabel");w(this,"activeSectionId",null);w(this,"sectionsOrder",[])}init(){var a,p,b,L,y;this.sectionOverlay=document.querySelector("#section-overlay"),this.sectionLabel=document.querySelector("#label"),window.addEventListener("message",({data:A})=>{this.handleMessage(A)}),(a=this.sectionOverlay.querySelector("#move-up"))==null||a.addEventListener("click",this.moveActiveSectionUp.bind(this)),(p=this.sectionOverlay.querySelector("#move-down"))==null||p.addEventListener("click",this.moveActiveSectionDown.bind(this)),(b=this.sectionOverlay.querySelector("#edit"))==null||b.addEventListener("click",this.editActiveSection.bind(this)),(L=this.sectionOverlay.querySelector("#disable"))==null||L.addEventListener("click",this.disableActiveSection.bind(this)),(y=this.sectionOverlay.querySelector("#remove"))==null||y.addEventListener("click",this.removeActiveSection.bind(this)),this.attachMouseEventsToSections(),this.postMessage("initialize",{themeData:window.themeData,templates:window.templates,settingsSchema:window.settingsSchema}),this.sectionsOrder=window.themeData.sectionsOrder,this.extractUsedColors()}attachMouseEventsToSections(){document.querySelectorAll("[data-section-type]").forEach(a=>{a.hasAttribute("data-visual-initialized")||(a.addEventListener("mouseover",this.onSectionHover.bind(this,a)),a.addEventListener("mouseleave",p=>{p.toElement&&this.sectionOverlay.contains(p.toElement)||this.onSectionBlur.call(this,a)}),a.setAttribute("data-visual-initialized","true"))})}highlightSection(a){this.activeSectionId=a.dataset.sectionId,this.sectionOverlay.style.display="block",this.sectionOverlay.style.width=a.offsetWidth+"px",this.sectionOverlay.style.height=a.offsetHeight+"px",this.sectionOverlay.style.left=a.offsetLeft+"px",this.sectionOverlay.style.top=a.offsetTop+"px",a.dataset.sectionType,this.sectionLabel.textContent=a.dataset.sectionName,this.sectionOverlay.querySelector("#move-up").style.display="none",this.sectionOverlay.querySelector("#move-down").style.display="none";const p=this.sectionsOrder.indexOf(this.activeSectionId);p>0&&(this.sectionOverlay.querySelector("#move-up").style.display="inline"),p<this.sectionsOrder.length-1&&(this.sectionOverlay.querySelector("#move-down").style.display="inline")}clearActiveSection(){this.activeSectionId=null,this.sectionOverlay.style.display="none"}onSectionHover(a){this.activeSectionId!==a.dataset.sectionId&&this.highlightSection(a)}onSectionBlur(a){this.activeSectionId===a.dataset.sectionId&&this.clearActiveSection()}moveActiveSectionUp(){this.postMessage("moveSectionUp",this.activeSectionId)}moveActiveSectionDown(){this.postMessage("moveSectionDown",this.activeSectionId)}editActiveSection(){this.postMessage("editSection",this.activeSectionId)}disableActiveSection(){this.postMessage("toggleSection",this.activeSectionId)}removeActiveSection(){this.postMessage("removeSection",this.activeSectionId)}refreshPreviewer(a){const p=new DOMParser().parseFromString(a,"text/html");C.morph(document.documentElement,p.documentElement,{callbacks:{beforeNodeMorphed(b,L){return typeof b._x_dataStack<"u"&&typeof window.Alpine.morph<"u"?(window.Alpine.morph(b,L),!1):!0}}}),this.attachMouseEventsToSections()}postMessage(a,p){window.parent.postMessage({type:a,data:p},window.origin)}handleMessage({type:a,data:p}){switch(a){case"highlightSection":const b=document.querySelector(`[data-section-id="${p}"]`);b&&(this.highlightSection(b),b.scrollIntoView({behavior:"smooth"}));break;case"clearActiveSection":this.clearActiveSection();break;case"sectionsOrder":this.sectionsOrder=p;break;case"refresh":this.refreshPreviewer(p);break}}extractUsedColors(a=6){const p=new Map;document.querySelectorAll("*").forEach(y=>{const A=getComputedStyle(y),H=A.backgroundColor,O=A.color,I=T=>{T!=="transparent"&&T!=="rgba(0, 0, 0, 0)"&&T!==""&&p.set(T,(p.get(T)||0)+1)};I(H),I(O)});const L=Array.from(p.entries()).sort((y,A)=>A[1]-y[1]).map(y=>y[0]).slice(0,a);this.postMessage("usedColors",L)}}
