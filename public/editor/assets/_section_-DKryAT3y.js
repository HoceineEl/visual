import{_ as G,g as ee,r as oe,a as te,b as ne,c as se,d as le,e as ce}from"./utils-CdEGNlIy.js";import{d as E,u as P,a3 as O,o,c as m,a as u,b as s,t as h,w as L,f as _,g as ae,h as re,F as S,r as C,a0 as ie,I as x,R as n,e as w,O as i,i as B,a4 as $,a5 as ue}from"./index-BSiW-uC3.js";import{r as de,a as me,b as pe,S as fe,c as _e}from"./sortable.core.esm-CbuXW7KB.js";import{r as U}from"./TextInput.vue_vue_type_script_setup_true_lang-BqjJhPHh.js";const ge={class:""},ve=["data-disabled"],ke={class:"handle flex-none py-1 px-1 rounded-md hover:bg-zinc-200 cursor-move"},be={class:"w-0 flex-1 truncate text-xs capitalize"},xe=E({__name:"Block",props:{block:null},emits:["remove","toggle"],setup(d,{emit:y}){const g=P(),l=O(),t=y,a=d;function k(){g.push({name:"/[section].[block]",params:{block:a.block.id,section:l.params.section}})}return(f,r)=>{const b=de,I=U,D=me,V=pe;return o(),m("div",ge,[u("div",{class:"flex rounded border border-zinc-100 hover:bg-zinc-100 cursor-pointer active:ring-inset active:ring-2 active:ring-gray-700 data-[disabled=true]:text-zinc-500","data-disabled":d.block.disabled},[u("button",ke,[s(b,{class:"inline w-3"})]),u("div",{onClick:k,class:"group mx-2 py-1 pr-1 text-sm flex-1 flex items-center max-w-full"},[u("div",be,h(d.block.settings.title||d.block.settings.heading||d.block.settings.text||d.block.name),1),u("button",{onClick:r[0]||(r[0]=L(z=>t("remove"),["stop"])),class:"flex-none invisible group-hover:visible py-[1px] px-[2px] rounded-md hover:bg-zinc-200"},[s(I,{class:"inline w-4"})]),u("button",{onClick:r[1]||(r[1]=L(z=>t("toggle"),["stop"])),class:"flex-none invisible group-hover:visible py-[1px] px-[2px] rounded-md hover:bg-zinc-200 ml-1"},[d.block.disabled?(o(),_(V,{key:1,class:"inline w-4"})):(o(),_(D,{key:0,class:"inline w-4"}))])])],8,ve)])}}}),he=E({__name:"BlocksGroup",props:{blocks:null,order:null},emits:["reorder","toggleBlock","removeBlock"],setup(d,{emit:y}){const g=d,l=y,t=ae("sortable");return re(()=>{new fe(t.value,{animation:150,ghostClass:"sortable-ghost",onEnd({newIndex:a,oldIndex:k}){const f=[...g.order],r=f.splice(k,1)[0];f.splice(a,0,r),l("reorder",f)}})}),(a,k)=>{const f=xe;return o(),m("div",{ref_key:"sortable",ref:t,class:"space-y-1"},[(o(!0),m(S,null,C(d.blocks,r=>(o(),_(f,{block:r,onToggle:b=>l("toggleBlock",r.id),onRemove:b=>l("removeBlock",r.id)},null,8,["block","onToggle","onRemove"]))),256))],512)}}}),ye={key:0,class:"flex flex-col h-full overflow-hidden relative w-full"},we={class:"flex-none p-2 border-b"},Be={class:"flex items-center"},$e={class:"ml-2 truncate"},Se={key:0,class:"mt-2 text-sm"},Ie={class:"flex-1 overflow-y-auto"},Re={key:1},Te={key:0,class:"flex-none border-t"},ze=E({__name:"[section]",setup(d){const y=P(),g=O(),l=ie(),t=x(()=>l.getSectionData(g.params.section)),a=x(()=>t.value?l.getSectionBySlug(t.value.type):null),k=x(()=>l.canRemoveSection(g.params.section)),f=x(()=>{var e;return ee(((e=a.value)==null?void 0:e.settings)||[])}),r=x(()=>t.value.blocks_order.map(e=>t.value.blocks[e])),b=x(()=>{var c;const e=((c=a.value)==null?void 0:c.blocks)||[];return r.value.length===0?e:e.filter(v=>{const R=r.value.filter(T=>T.type===v.type);return v.limit===void 0?!0:R.length<v.limit})});function I(){y.back()}function D(){l.removeSection(g.params.section),I()}function V(e){return l.getThemeDataValue(`sectionsData.${t.value.id}.settings.${e}`)}function z(e,c){return l.updateThemeDataValue(`sectionsData.${t.value.id}.settings.${e}`,c)}function j(e){const c=a.value.blocks.find(v=>v.type===e);l.addBlockToSection(t.value.id,c)}function q(e){l.updateThemeDataValue(["sectionsData",t.value.id,"blocks_order"],e)}function H(e){l.toggleSectionBlock(t.value.id,e)}function J(e){l.removeSectionBlock(t.value.id,e)}return(e,c)=>{const v=oe,R=ue,T=te,N=ne,K=he,Q=_e,M=se,F=le,W=ce,X=G,Y=U;return n(a)?(o(),m("div",ye,[u("header",we,[u("div",Be,[u("button",{class:"p-1 px-2 rounded hover:bg-gray-200 focus:outline-none",onClick:I},[s(v,{class:"inline w-4"})]),u("span",$e,h(n(t).settings.heading||n(a).name),1)]),n(a).description?(o(),m("p",Se,h(n(a).description),1)):w("",!0)]),u("section",Ie,[s(X,{multiple:"",defaultValue:["blocks","Settings"]},{default:i(()=>[n(a).blocks.length>0?(o(),_(F,{key:0,value:"blocks"},{default:i(()=>[s(N,null,{default:i(()=>[c[1]||(c[1]=B(" Blocks ")),s(T,null,{default:i(()=>[s(R)]),_:1})]),_:1}),s(M,null,{default:i(()=>[s(K,{class:"-mt-2 mb-2",blocks:n(r),order:n(t).blocks_order,onReorder:q,onToggleBlock:H,onRemoveBlock:J},null,8,["blocks","order"]),n(b).length>0?(o(),_(n($).Root,{key:0,onSelect:c[0]||(c[0]=p=>j(p.value))},{default:i(()=>[s(n($).Trigger,{class:"w-full text-sm text-blue-600 rounded-lg cursor-pointer outline-0 inline-flex items-center gap-2 px-2 py-1 hover:bg-gray-200 focus:ring-1 focus:ring-gray-700"},{default:i(()=>[s(Q,{class:"w-4 h-4 inline mr-1"}),c[2]||(c[2]=B(" Add Block "))]),_:1}),s(n($).Positioner,{class:"w-[var(--reference-width)] !z-10"},{default:i(()=>[s(n($).Content,{class:"flex flex-col outline-0 gap-1 p-1 bg-white shadow border rounded-lg data-[state=open]:animate-fade-in"},{default:i(()=>[(o(!0),m(S,null,C(n(b),p=>(o(),_(n($).Item,{key:p.type,value:p.type,class:"outline-0 rounded cursor-pointer px-2 py-2 hover:bg-gray-200"},{default:i(()=>[B(h(p.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:1})):w("",!0)]),_:1})]),_:1})):w("",!0),(o(!0),m(S,null,C(n(f),p=>(o(),_(F,{value:p.name,key:p.name},{default:i(()=>[s(N,null,{default:i(()=>[B(h(p.name)+" ",1),s(T,null,{default:i(()=>[s(R)]),_:1})]),_:2},1024),s(M,null,{default:i(()=>[(o(!0),m(S,null,C(p.settings,A=>(o(),_(W,{key:A.id,value:V(A.id),setting:A,onInput:Z=>z(A.id,Z)},null,8,["value","setting","onInput"]))),128))]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1}),n(a).settings.length>0?(o(),m(S,{key:0},[],64)):(o(),m("p",Re,h("This section has no configuration")))]),n(k)?(o(),m("footer",Te,[u("button",{class:"flex items-center w-full text-left py-2 px-4 text-red-500 hover:bg-gray-100",onClick:D},[s(Y,{class:"inline mr-2 w-4"}),c[3]||(c[3]=B(" Remove section "))])])):w("",!0)])):w("",!0)}}});export{ze as default};
