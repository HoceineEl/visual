import{_ as Y,g as Z,r as G,a as ee,b as te,c as oe,d as ne,e as se}from"./utils-Cng5Ysh1.js";import{d as z,u as F,a3 as L,o,c as d,a as u,b as e,t as b,w as M,g as le,h as re,F as B,r as R,f as x,a0 as ae,I as k,R as t,e as y,O as a,i as w,a4 as $,a5 as ce}from"./index-Bwvud4Ej.js";import{r as ie,a as ue,S as de,b as me}from"./sortable.core.esm-U_-uDiuY.js";import{r as P}from"./TextInput.vue_vue_type_script_setup_true_lang-Di6k8WGT.js";const pe={class:""},fe={class:"flex rounded border border-zinc-100 hover:bg-zinc-100 cursor-pointer active:ring-inset active:ring-2 active:ring-gray-700"},_e={class:"handle flex-none py-1 px-1 rounded-md hover:bg-zinc-200 cursor-move"},ge={class:"w-0 flex-1 truncate text-xs capitalize"},ve=z({__name:"Block",props:{block:null},emits:["remove","toggle"],setup(p,{emit:h}){const _=F(),c=L(),n=h,r=p;function v(){_.push({name:"/[section].[block]",params:{block:r.block.id,section:c.params.section}})}return(f,i)=>{const S=ie,I=P,T=ue;return o(),d("div",pe,[u("div",fe,[u("button",_e,[e(S,{class:"inline w-3"})]),u("div",{onClick:v,class:"group mx-2 py-1 pr-1 text-sm flex-1 flex items-center max-w-full"},[u("div",ge,b(p.block.settings.title||p.block.settings.heading||p.block.settings.text||p.block.name),1),u("button",{onClick:i[0]||(i[0]=M(V=>n("remove"),["stop"])),class:"flex-none invisible group-hover:visible py-[1px] px-[2px] rounded-md hover:bg-zinc-200"},[e(I,{class:"inline w-4"})]),u("button",{onClick:i[1]||(i[1]=M(V=>n("toggle"),["stop"])),class:"flex-none invisible group-hover:visible py-[1px] px-[2px] rounded-md hover:bg-zinc-200 ml-1"},[e(T,{class:"inline w-4"})])])])])}}}),ke=z({__name:"BlocksGroup",props:{blocks:null,order:null},emits:["reorder"],setup(p,{emit:h}){const _=p,c=h,n=le("sortable");return re(()=>{new de(n.value,{animation:150,ghostClass:"sortable-ghost",onEnd({newIndex:r,oldIndex:v}){const f=[..._.order],i=f.splice(v,1)[0];f.splice(r,0,i),c("reorder",f)}})}),(r,v)=>{const f=ve;return o(),d("div",{ref_key:"sortable",ref:n,class:"space-y-1"},[(o(!0),d(B,null,R(p.blocks,i=>(o(),x(f,{block:i},null,8,["block"]))),256))],512)}}}),be={key:0,class:"flex flex-col h-full overflow-hidden relative w-full"},xe={class:"flex-none p-2 border-b"},he={class:"flex items-center"},ye={class:"ml-2 truncate"},we={key:0,class:"mt-2 text-sm"},$e={class:"flex-1 overflow-y-auto"},Be={key:1},Se={key:0,class:"flex-none border-t"},Re=z({__name:"[section]",setup(p){const h=F(),_=L(),c=ae(),n=k(()=>c.getSectionData(_.params.section)),r=k(()=>n.value?c.getSectionBySlug(n.value.type):null),v=k(()=>c.canRemoveSection(_.params.section)),f=k(()=>{var s;return Z(((s=r.value)==null?void 0:s.settings)||[])}),i=k(()=>n.value.blocksOrder.map(s=>n.value.blocks[s])),S=k(()=>{var l;const s=((l=r.value)==null?void 0:l.blocks)||[];return i.value.length===0?s:s.filter(g=>{const A=i.value.filter(C=>C.type===g.type);return g.limit===void 0?!0:A.length<g.limit})});function I(){h.back()}function T(){c.removeSection(_.params.section),I()}function V(s){return c.getThemeDataValue(`sectionsData.${n.value.id}.settings.${s}`)}function U(s,l){return c.updateThemeDataValue(`sectionsData.${n.value.id}.settings.${s}`,l)}function j(s){const l=r.value.blocks.find(g=>g.type===s);c.addBlockToSection(n.value.id,l)}function q(s){c.updateThemeDataValue(`sectionsData.${n.value.id}.blocksOrder`,s)}return(s,l)=>{const g=G,A=ce,C=ee,N=te,H=ke,J=me,O=oe,E=ne,K=se,Q=Y,W=P;return t(r)?(o(),d("div",be,[u("header",xe,[u("div",he,[u("button",{class:"p-1 px-2 rounded hover:bg-gray-200 focus:outline-none",onClick:I},[e(g,{class:"inline w-4"})]),u("span",ye,b(t(n).settings.heading||t(r).name),1)]),t(r).description?(o(),d("p",we,b(t(r).description),1)):y("",!0)]),u("section",$e,[e(Q,{multiple:"",defaultValue:["blocks","Settings"]},{default:a(()=>[t(r).blocks.length>0?(o(),x(E,{key:0,value:"blocks"},{default:a(()=>[e(N,null,{default:a(()=>[l[1]||(l[1]=w(" Blocks ")),e(C,null,{default:a(()=>[e(A)]),_:1})]),_:1}),e(O,null,{default:a(()=>[e(H,{class:"-mt-2 mb-2",blocks:t(i),order:t(n).blocksOrder,onReorder:q},null,8,["blocks","order"]),t(S).length>0?(o(),x(t($).Root,{key:0,onSelect:l[0]||(l[0]=m=>j(m.value))},{default:a(()=>[e(t($).Trigger,{class:"w-full text-sm text-blue-600 rounded-lg cursor-pointer outline-0 inline-flex items-center gap-2 px-2 py-1 hover:bg-gray-200 focus:ring-1 focus:ring-gray-700"},{default:a(()=>[e(J,{class:"w-4 h-4 inline mr-1"}),l[2]||(l[2]=w(" Add Block "))]),_:1}),e(t($).Positioner,{class:"w-[var(--reference-width)] !z-10"},{default:a(()=>[e(t($).Content,{class:"flex flex-col outline-0 gap-1 p-1 bg-white shadow border rounded-lg data-[state=open]:animate-fade-in"},{default:a(()=>[(o(!0),d(B,null,R(t(S),m=>(o(),x(t($).Item,{key:m.type,value:m.type,class:"outline-0 rounded cursor-pointer px-2 py-2 hover:bg-gray-200"},{default:a(()=>[w(b(m.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:1})):y("",!0)]),_:1})]),_:1})):y("",!0),(o(!0),d(B,null,R(t(f),m=>(o(),x(E,{value:m.name,key:m.name},{default:a(()=>[e(N,null,{default:a(()=>[w(b(m.name)+" ",1),e(C,null,{default:a(()=>[e(A)]),_:1})]),_:2},1024),e(O,null,{default:a(()=>[(o(!0),d(B,null,R(m.settings,D=>(o(),x(K,{key:D.id,value:V(D.id),setting:D,onInput:X=>U(D.id,X)},null,8,["value","setting","onInput"]))),128))]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1}),t(r).settings.length>0?(o(),d(B,{key:0},[],64)):(o(),d("p",Be,b("This section has no configuration")))]),t(v)?(o(),d("footer",Se,[u("button",{class:"flex items-center w-full text-left py-2 px-4 text-red-500 hover:bg-gray-100",onClick:T},[e(W,{class:"inline mr-2 w-4"}),l[3]||(l[3]=w(" Remove section "))])])):y("",!0)])):y("",!0)}}});export{Re as default};
